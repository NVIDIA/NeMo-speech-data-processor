documentation: |
  Bootstrap metric processor
  ##########################

  This config is used to process a custom speech dataset using the `BootstrapProcessor` class for bootstrapped metric computation (WER, CER, WMR, etc.). It calculates metrics like Word Error Rate (WER) or other custom metrics such as Character Error Rate (CER) or Word Match Rate (WMR), depending on the config.

  This config performs the following data processing:

  1. Loads the speech dataset from manifest files in JSONL format.
  2. Applies bootstrapped metric calculation for the selected metric type.
  3. Optionally performs pairwise comparison between models, calculating the difference in performance between different model predictions.
  4. Saves the results, including mean metric values, confidence intervals, and optional Probability of Improvement (POI) values.

  **Required arguments**:

  * **workspace_dir**: Specify the workspace folder where the results will be stored.
  * **raw_data_dir**: Specify the data folder where all the datawill be stored.
  * **bootstrap_manifest_files**: List of file paths to the manifest files in JSONL format.
  * **metric_type**: The metric to compute. Supported options include 'wer', 'cer', 'wmr', 'charrate', 'wordrate'.
  * **dataset_size**: Proportion of dataset size for each bootstrap sample.
  * **num_bootstraps**: The number of bootstrap iterations for metric computation.
  * **ci_lower**: Lower bound percentile for confidence intervals (default: 2.5).
  * **ci_upper**: Upper bound percentile for confidence intervals (default: 97.5).
  * **calculate_pairwise**: Whether to calculate pairwise metric difference and POI
  * **text_key**: The key in the manifest that contains the ground truth text
  * **pred_text_key**: The key in the manifest that contains the predicted text
  * **random_state**: Random state of the program

  **Output format**:

  The config generates the following outputs:

  * **output_manifest_file**: A JSON file containing the results of the metric computation.
  * The output file will contain fields for the mean metric value, confidence intervals (ci_lower, ci_upper), and optional pairwise comparisons between models.

processors_to_run: all
workspace_dir: ???
bootstrap_manifest_files: ["manifest1.json", "manifest2.json"]
final_manifest: ${workspace_dir}/manifest.json
metric_type: "wer"
num_bootstraps: 1000
ci_lower: 2.5
ci_upper: 97.5

processors:
  - _target_: sdp.utils.BootstrapProcessor
    bootstrap_manifest_files: ${bootstrap_manifest_files}
    raw_data_dir: ${workspace_dir}/data
    num_bootstraps: ${num_bootstraps}
    dataset_size: 1.0
    output_manifest_file: ${final_manifest}
    calculate_pairwise: true
    metric_type: ${metric_type}
    text_key: "text"
    pred_text_key: "pred_text"
    ci_lower: ${ci_lower}
    ci_upper: ${ci_upper}
    random_state: 42
